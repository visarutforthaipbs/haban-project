import{f as y,g as K,o as Q,j as e,h as he,e as C,I as v,c as X,l as me,m as ue,r as l,n as Z,p as ee,B as I,q as pe,s as fe,S as W,d as q}from"./index-DaKMN1yZ.js";import{V as P,e as xe,f as ge,g as je,h as ye,i as be,j as G,k as Se,l as ve}from"./index-DCkPA7ii.js";import{b as Ce,M as Ie,I as T,a as U,D as Y}from"./DogListView-DOMIF1io.js";import{C as Le,T as we,a as Fe,b as A,c as _e,d as B}from"./chunk-IAXSQ4X2-DacyWhRH.js";import{g as ke,T as j,B as z}from"./chunk-ZHMYA64R-DpJu8I27.js";import{A as se}from"./chunk-V7PAE35Z-Pi7vmoPR.js";import{u as Ne,F as k,I as $}from"./chunk-6CVSDS6C-BbEwV9Gm.js";import{F as Pe}from"./chunk-VGESXGVT-DsD-yEVV.js";import{F as N}from"./chunk-H46NUPBZ-DTsN5Duz.js";import{T as ze}from"./chunk-4IH3O7BJ-BRPz7fCs.js";import{u as De,c as Me,M as Ee,a as Te,b as Ue}from"./chunk-4FCEGNGT-Dti3ODPF.js";import{C as Ae}from"./chunk-5MKCW436-Crl8gLHr.js";import{H as Be}from"./chunk-W7WUSNWJ-xyNjI2Wo.js";import{H as J}from"./chunk-7OLJDQMT-BqdKiONh.js";import{B as Re}from"./chunk-Z6RXEUPO-VoMs9AXz.js";import"./iconBase-_M4XJSaB.js";import"./index-DM64X-fq.js";import"./chunk-QINAG4RG-CdqfM4pg.js";var[He,te]=he({name:"ListStylesContext",errorMessage:`useListStyles returned is 'undefined'. Seems you forgot to wrap the components in "<List />" `}),D=y(function(r,o){const s=K("List",r),{children:a,styleType:i="none",stylePosition:d,spacing:h,...p}=Q(r),u=ke(a),m=h?{["& > *:not(style) ~ *:not(style)"]:{mt:h}}:{};return e.jsx(He,{value:s,children:e.jsx(C.ul,{ref:o,listStyleType:i,listStylePosition:d,role:"list",__css:{...s.container,...m},...p,children:u})})});D.displayName="List";var Oe=y((t,r)=>{const{as:o,...s}=t;return e.jsx(D,{ref:r,as:"ol",styleType:"decimal",marginStart:"1em",...s})});Oe.displayName="OrderedList";var Ve=y(function(r,o){const{as:s,...a}=r;return e.jsx(D,{ref:o,as:"ul",styleType:"initial",marginStart:"1em",...a})});Ve.displayName="UnorderedList";var R=y(function(r,o){const s=te();return e.jsx(C.li,{ref:o,...r,__css:s.item})});R.displayName="ListItem";var H=y(function(r,o){const s=te();return e.jsx(v,{ref:o,role:"presentation",...r,__css:s.icon})});H.displayName="ListIcon";var re=y((t,r)=>{const{className:o,...s}=t,a=X("chakra-modal__footer",o),d={display:"flex",alignItems:"center",justifyContent:"flex-end",...De().footer};return e.jsx(C.footer,{ref:r,...s,__css:d,className:a})});re.displayName="ModalFooter";var oe=y(function(r,o){const{children:s,placeholder:a,className:i,...d}=r;return e.jsxs(C.select,{...d,ref:o,className:X("chakra-select",i),children:[a&&e.jsx("option",{value:"",children:a}),s]})});oe.displayName="SelectField";function We(t,r){const o={},s={};for(const[a,i]of Object.entries(t))r.includes(a)?o[a]=i:s[a]=i;return[o,s]}var ne=y((t,r)=>{var o;const s=K("Select",t),{rootProps:a,placeholder:i,icon:d,color:h,height:p,h:u,minH:f,minHeight:m,iconColor:x,iconSize:g,...S}=Q(t),[c,b]=We(S,ue),L=Ne(b),w={width:"100%",height:"fit-content",position:"relative",color:h},M={paddingEnd:"2rem",...s.field,_focus:{zIndex:"unset",...(o=s.field)==null?void 0:o._focus}};return e.jsxs(C.div,{className:"chakra-select__wrapper",__css:w,...c,...a,children:[e.jsx(oe,{ref:r,height:u??p,minH:f??m,placeholder:i,...L,__css:M,children:t.children}),e.jsx(ae,{"data-disabled":me(L.disabled),...(x||h)&&{color:x||h},__css:s.icon,...g&&{fontSize:g},children:d})]})});ne.displayName="Select";var qe=t=>e.jsx("svg",{viewBox:"0 0 24 24",...t,children:e.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),Ge=C("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),ae=t=>{const{children:r=e.jsx(qe,{}),...o}=t,s=l.cloneElement(r,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return e.jsx(Ge,{...o,className:"chakra-select__icon-wrapper",children:l.isValidElement(r)?s:null})};ae.displayName="SelectIcon";const Ye=({isOpen:t,onClose:r,onUpdate:o})=>{const{user:s,refreshUser:a}=Z(),i=ee(),d=l.useRef(null),[h,p]=l.useState((s==null?void 0:s.name)||""),[u,f]=l.useState((s==null?void 0:s.bio)||""),[m,x]=l.useState((s==null?void 0:s.preferredContact)||""),[g,S]=l.useState((s==null?void 0:s.contactInfo)||""),[c,b]=l.useState(null),[L,w]=l.useState(s==null?void 0:s.profileImage),[M,O]=l.useState(!1),[E,F]=l.useState("");l.useEffect(()=>{t&&s&&(p(s.name||""),f(s.bio||""),x(s.preferredContact||""),S(s.contactInfo||""),w(s.profileImage),F(""))},[t,s]);const ie=n=>{var V;const _=(V=n.target.files)==null?void 0:V[0];if(_){if(_.size>5*1024*1024){i({title:"ไฟล์มีขนาดใหญ่เกินไป",description:"กรุณาอัปโหลดรูปภาพที่มีขนาดไม่เกิน 5MB",status:"error",duration:3e3,isClosable:!0});return}b(_);const de=URL.createObjectURL(_);w(de)}},le=async()=>{if(!h.trim()){F("ชื่อไม่สามารถเป็นค่าว่างได้");return}try{O(!0),F("");const n=new FormData;n.append("name",h),u!==void 0&&n.append("bio",u),m!==void 0&&n.append("preferredContact",m),g!==void 0&&n.append("contactInfo",g),c&&n.append("profileImage",c),await pe.patch("/api/users/profile",n,{headers:{"Content-Type":"multipart/form-data"}}),await a(),i({title:"อัพเดทโปรไฟล์สำเร็จ",status:"success",duration:3e3,isClosable:!0}),o(),r()}catch(n){console.error("Error updating profile:",n),F("ไม่สามารถอัพเดทโปรไฟล์ได้ กรุณาลองใหม่อีกครั้ง"),i({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถอัพเดทโปรไฟล์ได้ กรุณาลองใหม่อีกครั้ง",status:"error",duration:5e3,isClosable:!0})}finally{O(!1)}},ce=()=>{switch(m){case"email":return"อีเมลของคุณ";case"phone":return"เบอร์โทรศัพท์ของคุณ";case"line":return"ID Line ของคุณ";case"facebook":return"ชื่อผู้ใช้หรือลิงก์ Facebook ของคุณ";case"instagram":return"ชื่อผู้ใช้ Instagram ของคุณ";default:return"ข้อมูลการติดต่อของคุณ"}};return e.jsxs(Me,{isOpen:t,onClose:r,size:"md",children:[e.jsx(Ee,{}),e.jsxs(Ce,{children:[e.jsx(Ie,{children:"แก้ไขโปรไฟล์"}),e.jsx(Te,{}),e.jsx(Ue,{children:e.jsxs(P,{spacing:6,children:[e.jsxs(Le,{position:"relative",width:"100%",children:[e.jsx("input",{type:"file",hidden:!0,ref:d,accept:"image/*",onChange:ie}),e.jsxs(I,{position:"relative",cursor:"pointer",onClick:()=>{var n;return(n=d.current)==null?void 0:n.click()},textAlign:"center",children:[e.jsx(se,{size:"xl",name:s==null?void 0:s.name,src:L,bg:"brand.500",color:"white",mb:2}),e.jsx(I,{position:"absolute",bottom:"8px",right:"0",bg:"brand.500",borderRadius:"full",p:1,color:"white",children:e.jsx(v,{as:xe,boxSize:4})}),e.jsx(j,{fontSize:"sm",color:"brand.600",mt:1,children:"อัปโหลดรูปโปรไฟล์"})]})]}),e.jsx(j,{fontSize:"sm",color:"gray.500",textAlign:"center",children:s==null?void 0:s.email}),e.jsxs(k,{isInvalid:!!E,isRequired:!0,children:[e.jsx(N,{children:"ชื่อ"}),e.jsxs(T,{children:[e.jsx(U,{children:e.jsx(v,{as:ge,color:"gray.500"})}),e.jsx($,{value:h,onChange:n=>p(n.target.value),placeholder:"ชื่อของคุณ"})]}),E&&e.jsx(Pe,{children:E})]}),e.jsxs(k,{children:[e.jsx(N,{children:"คำอธิบายสั้นๆ เกี่ยวกับตัวคุณ"}),e.jsxs(T,{children:[e.jsx(U,{children:e.jsx(v,{as:je,color:"gray.500"})}),e.jsx(ze,{value:u,onChange:n=>f(n.target.value),placeholder:"เขียนเกี่ยวกับตัวคุณสั้นๆ (ไม่เกิน 500 ตัวอักษร)",maxLength:500,paddingLeft:"40px",resize:"vertical"})]})]}),e.jsxs(k,{children:[e.jsx(N,{children:"ช่องทางการติดต่อที่ต้องการ"}),e.jsxs(ne,{placeholder:"เลือกช่องทางที่ต้องการให้ติดต่อ",value:m,onChange:n=>x(n.target.value),icon:e.jsx(v,{as:ye}),children:[e.jsx("option",{value:"email",children:"อีเมล"}),e.jsx("option",{value:"phone",children:"โทรศัพท์"}),e.jsx("option",{value:"line",children:"Line"}),e.jsx("option",{value:"facebook",children:"Facebook"}),e.jsx("option",{value:"instagram",children:"Instagram"})]})]}),m&&e.jsxs(k,{children:[e.jsx(N,{children:"ข้อมูลการติดต่อ"}),e.jsxs(T,{children:[e.jsx(U,{children:e.jsx(v,{as:be,color:"gray.500"})}),e.jsx($,{value:g,onChange:n=>S(n.target.value),placeholder:ce()})]})]})]})}),e.jsxs(re,{children:[e.jsx(z,{variant:"ghost",mr:3,onClick:r,children:"ยกเลิก"}),e.jsx(z,{colorScheme:"brand",onClick:le,isLoading:M,children:"บันทึก"})]})]})]})},ms=()=>{const{user:t,logout:r,refreshUser:o}=Z(),[s,a]=l.useState([]),[i,d]=l.useState(!0),[h,p]=l.useState(!1),u=fe(),f=ee();l.useEffect(()=>{(async()=>{if(t)try{const b=await q.getDogs({userId:t.id});a(b)}catch(b){console.error("Error fetching user's dogs:",b)}finally{d(!1)}})()},[t]);const m=s.filter(c=>c.type==="lost"),x=s.filter(c=>c.type==="found");if(!t)return u("/login"),null;const g=async()=>{try{await r(),u("/login")}catch{f({title:"ออกจากระบบไม่สำเร็จ",description:"กรุณาลองใหม่อีกครั้ง",status:"error",duration:3e3,isClosable:!0})}},S=async()=>{if(t)try{await o();const c=await q.getDogs({userId:t.id});a(c)}catch(c){console.error("Error refreshing user data:",c)}};return e.jsxs(Ae,{maxW:"container.md",py:8,children:[e.jsxs(P,{spacing:8,align:"stretch",children:[e.jsx(I,{bg:"white",p:6,borderRadius:"lg",shadow:"sm",children:e.jsxs(P,{spacing:4,align:"center",children:[e.jsx(se,{size:"2xl",name:t.name,src:t.profileImage,bg:"brand.500",color:"white"}),e.jsxs(P,{spacing:1,children:[e.jsx(J,{size:"lg",children:t.name}),e.jsx(j,{color:"gray.600",children:t.email}),t.bio&&e.jsxs(j,{color:"gray.600",textAlign:"center",fontSize:"sm",maxW:"90%",mt:2,children:['"',t.bio,'"']}),t.preferredContact&&e.jsxs(j,{color:"gray.500",fontSize:"xs",mt:1,children:["ติดต่อผ่าน:"," ",t.preferredContact==="email"?"อีเมล":t.preferredContact==="phone"?"โทรศัพท์":t.preferredContact==="line"?"Line":t.preferredContact==="facebook"?"Facebook":t.preferredContact==="instagram"?"Instagram":t.preferredContact,t.contactInfo&&` - ${t.contactInfo}`]}),e.jsx(Re,{colorScheme:"brand",fontSize:"sm",mt:2,children:"สมาชิก"})]}),e.jsxs(I,{w:"full",p:4,bg:"neutral.50",borderRadius:"md",children:[e.jsx(J,{size:"sm",mb:3,color:"brand.600",children:"สิทธิประโยชน์ของสมาชิก"}),e.jsxs(D,{spacing:2,children:[e.jsxs(R,{children:[e.jsx(H,{as:G,color:"brand.500"}),"รับการแจ้งเตือนเมื่อมีสุนัขที่ตรงกับที่คุณกำลังหา"]}),e.jsxs(R,{children:[e.jsx(H,{as:G,color:"brand.500"}),"บันทึกรายการที่สนใจไว้ดูภายหลัง"]})]})]}),e.jsxs(Be,{spacing:4,mt:4,children:[e.jsx(z,{leftIcon:e.jsx(Se,{}),variant:"outline",colorScheme:"brand",size:"sm",onClick:()=>p(!0),children:"แก้ไขโปรไฟล์"}),e.jsx(z,{leftIcon:e.jsx(ve,{}),colorScheme:"orange",variant:"ghost",size:"sm",onClick:g,children:"ออกจากระบบ"})]})]})}),e.jsx(I,{bg:"white",borderRadius:"lg",shadow:"sm",children:e.jsxs(we,{colorScheme:"brand",isFitted:!0,children:[e.jsxs(Fe,{children:[e.jsx(A,{children:"สุนัขที่แจ้งหาย"}),e.jsx(A,{children:"สุนัขที่พบ"}),e.jsx(A,{children:"รายการที่บันทึก"})]}),e.jsxs(_e,{children:[e.jsx(B,{children:i?e.jsx(W,{}):m.length>0?e.jsx(Y,{dogs:m,selectedDog:null,onDogSelect:()=>{},columns:{base:1,md:2,lg:2}}):e.jsx(j,{color:"gray.600",textAlign:"center",children:"ยังไม่มีรายการสุนัขที่แจ้งหาย"})}),e.jsx(B,{children:i?e.jsx(W,{}):x.length>0?e.jsx(Y,{dogs:x,selectedDog:null,onDogSelect:()=>{},columns:{base:1,md:2,lg:2}}):e.jsx(j,{color:"gray.600",textAlign:"center",children:"ยังไม่มีรายการสุนัขที่พบ"})}),e.jsx(B,{children:e.jsx(j,{color:"gray.600",textAlign:"center",children:"ยังไม่มีรายการที่บันทึก"})})]})]})})]}),e.jsx(Ye,{isOpen:h,onClose:()=>p(!1),onUpdate:S})]})};export{ms as default};
