import{r as l,i as oe,f as se,j as e,h as ue,e as K,c as pe,w as D,l as m,x as W,g as he,o as fe,y as me,m as ge,p as be,s as xe,n as ve,B as te,d as Ce}from"./index-DaKMN1yZ.js";import{F as _}from"./chunk-VGESXGVT-DsD-yEVV.js";import{F}from"./chunk-H46NUPBZ-DTsN5Duz.js";import{a as ye,F as w,I as A}from"./chunk-6CVSDS6C-BbEwV9Gm.js";import{d as je,T as ne,S as ae,B as ke}from"./chunk-ZHMYA64R-DpJu8I27.js";import{t as Pe}from"./index-DdrsuNi1.js";import{L as Se}from"./LocationPicker-BzlHDbK3.js";import{C as Re}from"./chunk-5MKCW436-Crl8gLHr.js";import{V as De}from"./index-DCkPA7ii.js";import{H as Ie}from"./chunk-7OLJDQMT-BqdKiONh.js";import{T as Fe}from"./chunk-4IH3O7BJ-BRPz7fCs.js";import"./leaflet-C4RW84Ki.js";import"./iconBase-_M4XJSaB.js";function we(o){return o&&oe(o)&&oe(o.target)}function Ee(o={}){const{onChange:p,value:n,defaultValue:a,name:h,isDisabled:f,isFocusable:g,isNative:x,...d}=o,[j,C]=l.useState(a||""),u=typeof n<"u",y=u?n:j,v=l.useRef(null),P=l.useCallback(()=>{const r=v.current;if(!r)return;let c="input:not(:disabled):checked";const R=r.querySelector(c);if(R){R.focus();return}c="input:not(:disabled)";const b=r.querySelector(c);b==null||b.focus()},[]),t=`radio-${l.useId()}`,S=h||t,k=l.useCallback(r=>{const c=we(r)?r.target.value:r;u||C(c),p==null||p(String(c))},[p,u]),O=l.useCallback((r={},c=null)=>({...r,ref:je(c,v),role:"radiogroup"}),[]),I=l.useCallback((r={},c=null)=>({...r,ref:c,name:S,[x?"checked":"isChecked"]:y!=null?r.value===y:void 0,onChange(b){k(b)},"data-radiogroup":!0}),[x,S,k,y]);return{getRootProps:O,getRadioProps:I,name:S,ref:v,focus:P,setValue:C,value:y,onChange:k,isDisabled:f,isFocusable:g,htmlProps:d}}var[qe,ie]=ue({name:"RadioGroupContext",strict:!1}),re=se((o,p)=>{const{colorScheme:n,size:a,variant:h,children:f,className:g,isDisabled:x,isFocusable:d,...j}=o,{value:C,onChange:u,getRootProps:y,name:v,htmlProps:P}=Ee(j),s=l.useMemo(()=>({name:v,size:a,onChange:u,colorScheme:n,value:C,variant:h,isDisabled:x,isFocusable:d}),[v,a,u,n,C,h,x,d]);return e.jsx(qe,{value:s,children:e.jsx(K.div,{...y(P,p),className:pe("chakra-radio-group",g),children:f})})});re.displayName="RadioGroup";var Ne={border:"0",clip:"rect(0, 0, 0, 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};function Le(o={}){const{defaultChecked:p,isChecked:n,isFocusable:a,isDisabled:h,isReadOnly:f,isRequired:g,onChange:x,isInvalid:d,name:j,value:C,id:u,"data-radiogroup":y,"aria-describedby":v,...P}=o,s=`radio-${l.useId()}`,t=ye(),k=!!ie()||!!y;let I=!!t&&!k?t.id:s;I=u??I;const r=h??(t==null?void 0:t.isDisabled),c=f??(t==null?void 0:t.isReadOnly),R=g??(t==null?void 0:t.isRequired),b=d??(t==null?void 0:t.isInvalid),[B,V]=l.useState(!1),[N,T]=l.useState(!1),[M,G]=l.useState(!1),[z,L]=l.useState(!1),[le,ce]=l.useState(!!p),U=typeof n<"u",E=U?n:le;l.useEffect(()=>Pe(V),[]);const $=l.useCallback(i=>{if(c||r){i.preventDefault();return}U||ce(i.target.checked),x==null||x(i)},[U,r,c,x]),J=l.useCallback(i=>{i.key===" "&&L(!0)},[L]),Y=l.useCallback(i=>{i.key===" "&&L(!1)},[L]),Q=l.useCallback((i={},q=null)=>({...i,ref:q,"data-active":m(z),"data-hover":m(M),"data-disabled":m(r),"data-invalid":m(b),"data-checked":m(E),"data-focus":m(N),"data-focus-visible":m(N&&B),"data-readonly":m(c),"aria-hidden":!0,onMouseDown:D(i.onMouseDown,()=>L(!0)),onMouseUp:D(i.onMouseUp,()=>L(!1)),onMouseEnter:D(i.onMouseEnter,()=>G(!0)),onMouseLeave:D(i.onMouseLeave,()=>G(!1))}),[z,M,r,b,E,N,c,B]),{onFocus:X,onBlur:Z}=t??{},de=l.useCallback((i={},q=null)=>{const ee=r&&!a;return{...i,id:I,ref:q,type:"radio",name:j,value:C,onChange:D(i.onChange,$),onBlur:D(Z,i.onBlur,()=>T(!1)),onFocus:D(X,i.onFocus,()=>T(!0)),onKeyDown:D(i.onKeyDown,J),onKeyUp:D(i.onKeyUp,Y),checked:E,disabled:ee,readOnly:c,required:R,"aria-invalid":W(b),"aria-disabled":W(ee),"aria-required":W(R),"data-readonly":m(c),"aria-describedby":v,style:Ne}},[r,a,I,j,C,$,Z,X,J,Y,E,c,R,b,v]);return{state:{isInvalid:b,isFocused:N,isChecked:E,isActive:z,isHovered:M,isDisabled:r,isReadOnly:c,isRequired:R},getCheckboxProps:Q,getRadioProps:Q,getInputProps:de,getLabelProps:(i={},q=null)=>({...i,ref:q,onMouseDown:D(i.onMouseDown,_e),"data-disabled":m(r),"data-checked":m(E),"data-invalid":m(b)}),getRootProps:(i,q=null)=>({...i,ref:q,"data-disabled":m(r),"data-checked":m(E),"data-invalid":m(b)}),htmlProps:P}}function _e(o){o.preventDefault(),o.stopPropagation()}function Me(o,p){const n={},a={};for(const[h,f]of Object.entries(o))p.includes(h)?n[h]=f:a[h]=f;return[n,a]}var H=se((o,p)=>{var n;const a=ie(),{onChange:h,value:f}=o,g=he("Radio",{...a,...o}),x=fe(o),{spacing:d="0.5rem",children:j,isDisabled:C=a==null?void 0:a.isDisabled,isFocusable:u=a==null?void 0:a.isFocusable,inputProps:y,...v}=x;let P=o.isChecked;(a==null?void 0:a.value)!=null&&f!=null&&(P=a.value===f);let s=h;a!=null&&a.onChange&&f!=null&&(s=me(a.onChange,h));const t=(n=o==null?void 0:o.name)!=null?n:a==null?void 0:a.name,{getInputProps:S,getCheckboxProps:k,getLabelProps:O,getRootProps:I,htmlProps:r}=Le({...v,isChecked:P,isFocusable:u,isDisabled:C,onChange:s,name:t}),[c,R]=Me(r,ge),b=k(R),B=S(y,p),V=O(),N=Object.assign({},c,I()),T={display:"inline-flex",alignItems:"center",verticalAlign:"top",cursor:"pointer",position:"relative",...g.container},M={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,...g.control},G={userSelect:"none",marginStart:d,...g.label};return e.jsxs(K.label,{className:"chakra-radio",...N,__css:T,children:[e.jsx("input",{className:"chakra-radio__input",...B}),e.jsx(K.span,{className:"chakra-radio__control",...b,__css:M}),j&&e.jsx(K.span,{className:"chakra-radio__label",...V,__css:G,children:j})]})});H.displayName="Radio";const Ae={breed:"",color:"",location:null,description:"",contact:"",photos:null,status:"temporary",foundDate:new Date().toISOString().split("T")[0]},eo=()=>{const[o,p]=l.useState(Ae),[n,a]=l.useState({}),[h,f]=l.useState(!1),g=be(),x=xe(),{user:d}=ve(),j=()=>{const s={};return o.breed||(s.breed="กรุณาระบุพันธุ์สุนัข"),o.color||(s.color="กรุณาระบุสีสุนัข"),o.location||(s.location="กรุณาระบุตำแหน่งที่พบ"),o.description||(s.description="กรุณาระบุรายละเอียด"),!o.contact&&!d&&(s.contact="กรุณาระบุข้อมูลการติดต่อ"),o.foundDate||(s.foundDate="กรุณาระบุวันที่พบ"),a(s),Object.keys(s).length===0},C=async s=>{if(s.preventDefault(),!j()){g({title:"Form Error",description:"Please fill in all required fields.",status:"error",duration:5e3,isClosable:!0});return}f(!0);try{const t=new FormData;t.append("type","found"),t.append("breed",o.breed),t.append("color",o.color),t.append("description",o.description),t.append("currentStatus",o.status),t.append("foundDate",new Date(o.foundDate).toISOString()),o.location&&(t.append("location",JSON.stringify({type:"Point",coordinates:[o.location.coordinates[1],o.location.coordinates[0]]})),t.append("locationName",o.location.name)),o.photos&&Array.from(o.photos).forEach(S=>{t.append("photos",S)}),d?(t.append("userId",d.id),t.append("userContact",d.email||""),d.contactInfo&&t.append("userContactInfo",d.contactInfo)):o.contact&&t.append("contact",o.contact),await Ce.createDog(t),g({title:"Report submitted",description:"Your found dog report has been submitted successfully.",status:"success",duration:5e3,isClosable:!0}),x("/map")}catch(t){console.error("Error submitting report:",t),g({title:"Error",description:"Failed to submit report. Please try again.",status:"error",duration:5e3,isClosable:!0})}finally{f(!1)}},u=s=>{const{name:t,value:S}=s.target;p(k=>({...k,[t]:S})),n[t]&&a(k=>({...k,[t]:""}))},y=s=>{s.target.files&&p(t=>({...t,photos:s.target.files}))},v=s=>{p(t=>({...t,status:s}))},P=s=>{p(t=>({...t,location:s})),n.location&&a(t=>({...t,location:""}))};return e.jsx(Re,{maxW:"container.md",py:8,children:e.jsxs(De,{spacing:8,align:"stretch",children:[e.jsxs(te,{textAlign:"center",children:[e.jsx(Ie,{size:"xl",color:"green.500",mb:2,children:"แจ้งพบสุนัข"}),e.jsx(ne,{color:"gray.600",fontSize:"lg",children:"กรอกข้อมูลสุนัขที่พบเพื่อช่วยเจ้าของตามหา"})]}),e.jsx(te,{as:"form",onSubmit:C,children:e.jsxs(ae,{spacing:6,children:[e.jsxs(w,{isRequired:!0,isInvalid:!!n.foundDate,children:[e.jsx(F,{children:"วันที่พบ"}),e.jsx(A,{name:"foundDate",type:"date",value:o.foundDate,onChange:u,max:new Date().toISOString().split("T")[0]}),e.jsx(_,{children:n.foundDate})]}),e.jsxs(w,{isRequired:!0,isInvalid:!!n.breed,children:[e.jsx(F,{children:"พันธุ์สุนัข"}),e.jsx(A,{name:"breed",value:o.breed,onChange:u,placeholder:"ระบุพันธุ์สุนัข เช่น ไทยหลังอาน, ชิวาวา, โกลเด้น"}),e.jsx(_,{children:n.breed})]}),e.jsxs(w,{isRequired:!0,isInvalid:!!n.color,children:[e.jsx(F,{children:"สี"}),e.jsx(A,{name:"color",value:o.color,onChange:u,placeholder:"ระบุสีขน เช่น น้ำตาล-ขาว, ดำ"}),e.jsx(_,{children:n.color})]}),e.jsxs(w,{isRequired:!0,isInvalid:!!n.location,children:[e.jsx(F,{children:"สถานที่พบ"}),e.jsx(Se,{onLocationSelect:P,defaultLocation:o.location||void 0}),e.jsx(_,{children:n.location})]}),e.jsxs(w,{isRequired:!0,isInvalid:!!n.description,children:[e.jsx(F,{children:"รายละเอียดเพิ่มเติม"}),e.jsx(Fe,{name:"description",value:o.description,onChange:u,placeholder:"ระบุรายละเอียดเพิ่มเติม เช่น สภาพสุนัข พฤติกรรม มีปลอกคอหรือไม่",rows:4}),e.jsx(_,{children:n.description})]}),e.jsxs(w,{children:[e.jsx(F,{children:"สถานะปัจจุบัน"}),e.jsx(re,{value:o.status,onChange:v,children:e.jsxs(ae,{direction:"row",spacing:4,children:[e.jsx(H,{value:"on_location",children:"อยู่จุดที่พบเจอ"}),e.jsx(H,{value:"temporary",children:"รับเลี้ยงชั่วคราว"}),e.jsx(H,{value:"shelter",children:"นำส่งศูนย์พักพิง"})]})})]}),!d&&e.jsxs(w,{isRequired:!0,isInvalid:!!n.contact,children:[e.jsx(F,{children:"ข้อมูลการติดต่อ"}),e.jsx(A,{name:"contact",value:o.contact,onChange:u,placeholder:"ระบุเบอร์โทร, LINE ID หรือช่องทางติดต่ออื่นๆ"}),e.jsx(_,{children:n.contact})]}),e.jsxs(w,{children:[e.jsx(F,{children:"รูปภาพ"}),e.jsx(ne,{fontSize:"sm",color:"gray.600",mb:2,children:"แนะนำให้อัพโหลดรูปที่เห็นตัวสุนัขชัดเจน หลายๆ มุม"}),e.jsx(A,{type:"file",name:"photos",accept:"image/*",multiple:!0,onChange:y})]}),e.jsx(ke,{type:"submit",colorScheme:"green",size:"lg",isLoading:h,loadingText:"กำลังส่งข้อมูล...",children:"แจ้งพบสุนัข"})]})})]})})};export{eo as default};
